{% extends 'main/base.html' %}

{% block title %}Home Page{% endblock %}

{% block content %}

<!-- ADD POST CTA -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="mb-0">Your Feed</h4>
    <a href="/create-post" class="btn btn-primary" style="background-color: #0c5b74; border: none; color: white; border-radius: 6px;">
        <i class="bi bi-pencil-square"></i> Add Post
    </a>
</div>

<hr>

<!-- POSTS LIST -->
{% for post in posts %}
<div class="card mt-3" style="background-color: #F2EFE9; border: 1px solid rgba(70, 130, 180, 0.2); border-radius: 8px;">
    <div class="card-header">
        <strong>@{{ post.author.username }}</strong>
    </div>

    <div class="card-body d-flex flex-row justify-content-between">
        <div class="me-3">
            <h5 class="card-title">{{ post.title }}</h5>
            <p class="card-text">{{ post.description }}</p>
            
        </div>

        <div class="text-end">
            {% if user == post.author or perms.main.delete_post %}
            <form method="post" class="mb-2">
                {% csrf_token %}
                <button
                    type="submit"
                    class="btn btn-danger btn-sm"
                    name="post-id"
                    style="background-color: #9b2424; border: none; color: white; border-radius: 6px;"
                    value="{{ post.id }}">
                    Delete
                </button>
            </form>
            {% endif %}

            {% if user.is_staff %}
            <form method="post">
                {% csrf_token %}
                <button
                    type="submit"
                    class="btn btn-warning btn-sm"
                    name="user-id"
                    style="background-color: #c2bf0e; border: none; color: white; border-radius: 6px;"
                    value="{{ post.author.id }}">
                    Ban User
                </button>
            </form>
            {% endif %}
        </div>
    </div>

    <div class="card-footer text-muted">
        {{ post.created_at }}
    </div>
</div>
{% empty %}
<p class="text-muted mt-4">No posts yet. Be the first to write one.</p>
{% endfor %}

{% endblock %}
